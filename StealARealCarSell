repeat task.wait() until game.Players.LocalPlayer
repeat task.wait() until game.Players.LocalPlayer.Character
repeat task.wait() until game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
repeat task.wait() until game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
repeat task.wait() until game.Players.LocalPlayer:FindFirstChild("Backpack")
repeat task.wait() until game:IsLoaded()
repeat task.wait() until workspace:FindFirstChild("Bases")
wait(2)

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

local MyBase = nil
repeat
	local Bases = Workspace:FindFirstChild("Bases")
	if Bases then
		for _, base in ipairs(Bases:GetChildren()) do
			local label = base:FindFirstChild("Title")
				and base.Title:FindFirstChild("NameGui")
				and base.Title.NameGui:FindFirstChild("TextLabel")

			if label and label.Text == LocalPlayer.Name then
				MyBase = base
				break
			end
		end
	end
	task.wait(1)
until MyBase

if MyBase:FindFirstChild("BuyHitbox") then
	MyBase.BuyHitbox.Size = Vector3.new(2000, 2000, 2000)
end

for _, base in ipairs(Workspace.Bases:GetChildren()) do
	if base ~= MyBase then
		for _, part in ipairs(base:GetDescendants()) do
			if part:IsA("BasePart") and (part.Name == "Wall" or part.Name == "Beam") then
				part:Destroy()
			end
		end
	end
end

task.spawn(function()
	while true do
		local hitbox = MyBase:FindFirstChild("LockBasePurchase") and MyBase.LockBasePurchase:FindFirstChild("Hitbox")
		if hitbox and HumanoidRootPart then
			firetouchinterest(hitbox, HumanoidRootPart, 0)
			task.wait(0.05)
			firetouchinterest(hitbox, HumanoidRootPart, 1)
		end
		task.wait(0.1)
	end
end)

local selling = false

task.spawn(function()
	while true do
		if selling then task.wait(1) continue end
		for _, base in ipairs(Workspace.Bases:GetChildren()) do
			if base ~= MyBase then
				for _, descendant in ipairs(base:GetDescendants()) do
					if descendant:IsA("ProximityPrompt") and descendant.Name == "SnatchPrompt" then
						local parent = descendant.Parent
						if parent and parent:IsA("BasePart") then
							HumanoidRootPart.CFrame = parent.CFrame + Vector3.new(0, 3, 0)
							task.wait(0.3)
							fireproximityprompt(descendant, 1)
							break
						end
					end
				end
			end
		end
		task.wait(0.3)
	end
end)

task.spawn(function()
	while true do
		local slots = MyBase:FindFirstChild("Slots")
		if slots then
			local partsCount = 0
			for _, folder in ipairs(slots:GetChildren()) do
				if folder:IsA("Folder") and folder.Name == "Parts" then
					partsCount += 1
				end
			end

			if partsCount == 10 then
				selling = true
				for _, obj in ipairs(slots:GetDescendants()) do
					if obj:IsA("ProximityPrompt") and obj.Name == "SellPrompt" then
						local parent = obj.Parent
						if parent and parent:IsA("BasePart") then
							HumanoidRootPart.CFrame = parent.CFrame + Vector3.new(0, 3, 0)
							task.wait(0.2)
							fireproximityprompt(obj, 1)
							task.wait(0.2)
						end
					end
				end
				task.wait(3)
				selling = false
			end
		end
		task.wait(1)
	end
end)
